<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Teknos TEKNOCEILING Competition</title>
<style>
:root{
  --brand:#007050;
  --bg:#f5f7f8;
  --card:#ffffff;
  --text:#0f1720;
  --muted:#5b6570;
  --danger:#b00020;
  --ok:#0f9d58;
}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background:var(--bg);
  color:var(--text);
}
.container{max-width:600px;margin:0 auto;padding:20px;}
.card{background:var(--card);padding:20px;border-radius:16px;box-shadow:0 4px 24px rgba(0,0,0,0.08);}
h1{margin:0 0 6px;font-size:24px;font-weight:800;}
.sub{color:var(--muted);margin-bottom:20px;}
label{display:block;margin-top:14px;margin-bottom:6px;font-weight:600;}
input{width:100%;padding:14px;border-radius:12px;border:1px solid #dfe5ea;font-size:16px;}
input:focus{border-color:var(--brand);outline:none;}
.checkbox-row{display:flex;align-items:flex-start;gap:10px;margin-top:14px;font-size:14px;}
button{width:100%;margin-top:18px;padding:14px;border:none;border-radius:12px;font-weight:700;font-size:16px;cursor:pointer;color:white;background:var(--brand);}
.msg{display:none;margin-top:14px;padding:12px;border-left:4px solid var(--ok);background:#e9f8ef;}
.msg.error{border-left-color:var(--danger);background:#ffeef0;}
.thankyou{text-align:center;display:none;padding:40px 10px;}
.kiosk{position:fixed;right:14px;bottom:14px;display:flex;gap:8px;}
.kiosk button{background:#fff;color:#222;border:1px solid #ccc;border-radius:999px;padding:8px 12px;font-size:13px;}
</style>
</head>
<body>

<div class="container">
  <div class="card" id="formCard">
    <h1>Teknos TEKNOCEILING Competition</h1>
    <div class="sub">Enter to win. Winner drawn every hour.</div>

    <form id="leadForm" autocomplete="off">
      <label>First name *</label>
      <input required name="firstName" />

      <label>Last name *</label>
      <input required name="lastName" />

      <label>Company *</label>
      <input required name="company" />

      <label>Email *</label>
      <input required type="email" name="email" />

      <label>Phone</label>
      <input name="phone" />

      <label class="checkbox-row">
        <input type="checkbox" name="marketingOptIn">
        <span>Yes, send me occasional product updates & events.</span>
      </label>

      <label class="checkbox-row">
        <input required type="checkbox" name="consent">
        <span>I consent to Teknos storing my details for this competition and follow-up.</span>
      </label>

      <button type="submit" id="btnSubmit">Submit</button>

      <div class="msg" id="msg"></div>
    </form>

    <div class="thankyou" id="thankYou">
      <h2>✅ You’re in!</h2>
      <p>Screen resets shortly...</p>
    </div>
  </div>
</div>

<div class="kiosk">
  <button id="btnSync">Sync now</button>
</div>

<script>
const ENDPOINT = "https://script.google.com/macros/s/AKfycbzk6XFWCvFJ0WU3zoig5OVVU6cIP6s7LpQ4GMnoKm_uBywBclZdUHm4fyRAKdjJaw9T/exec";
const BRAND_EVENT = "TEKNOCEILING Competition";
const queueKey = "teknosLeadQueue";

const $ = id => document.getElementById(id);
const getQueue = () => JSON.parse(localStorage.getItem(queueKey) || "[]");
const setQueue = q => localStorage.setItem(queueKey, JSON.stringify(q));
const addToQueue = p => { let q=getQueue(); q.push(p); setQueue(q); };
const popQueue = () => { let q=getQueue(); let i=q.shift(); setQueue(q); return i; };

async function sendPayload(payload){
  // text/plain avoids CORS preflight (Google Apps Script limitation)
  await fetch(ENDPOINT, {
    method:"POST",
    headers:{"Content-Type":"text/plain;charset=utf-8"},
    body:JSON.stringify(payload)
  });
}

function showThank(){
  $("leadForm").style.display="none";
  $("thankYou").style.display="block";
  setTimeout(()=>location.reload(), 3500);
}

$("leadForm").addEventListener("submit", async e=>{
  e.preventDefault();
  const fd = new FormData(e.target);
  const payload = {
    event: BRAND_EVENT,
    firstName: fd.get("firstName").trim(),
    lastName: fd.get("lastName").trim(),
    company: fd.get("company").trim(),
    email: fd.get("email").trim(),
    phone: fd.get("phone").trim(),
    marketingOptIn: fd.get("marketingOptIn") ? true : false,
    consent: true,
    userAgent: navigator.userAgent
  };
  try{
    await sendPayload(payload);
  }catch{
    addToQueue(payload);
  }
  showThank();
});

$("btnSync").addEventListener("click", async ()=>{
  while(getQueue().length){
    try{ await sendPayload(popQueue()); }
    catch{ break; }
  }
  alert("Synced any stored entries.");
});
</script>
</body>
</html>
